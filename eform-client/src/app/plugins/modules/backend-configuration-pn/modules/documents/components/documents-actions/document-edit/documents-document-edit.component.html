<h3 mat-dialog-title>{{'Edit document' | translate}}</h3>
<div mat-dialog-content class="d-flex flex-column">
  <mat-card class="mb-3">
    <mat-card-content *ngIf="folders !== undefined">
      <div class="d-flex flex-column">
        <mat-slide-toggle
          id="planAreaRuleStatusToggle"
          [(ngModel)]="newDocumentModel.status"
        >
          {{ 'Enabled' | translate }}
        </mat-slide-toggle>
        <mat-form-field>
          <mat-label>{{'Selected folder' | translate}}</mat-label>
          <mtx-select
            class="custom"
            dropdownPosition="bottom"
            [clearable]="false"
            [bindLabel]="'name'"
            [bindValue]="'id'"
            [(ngModel)]="selectedFolder"
            id="createLanguageSelector"
            [items]="folders"
          >
          </mtx-select>
        </mat-form-field>
      </div>
    </mat-card-content>
  </mat-card>
  <mat-card class="mb-3">
    <mat-card-title>{{ 'Assign to property' | translate }}</mat-card-title>
    <mat-card-content *ngIf="availableProperties !== undefined">
      <div class="d-grid grid-2-columns">
        <ng-container *ngFor="let property of availableProperties; let propertyIndex = index; last as isLast">
          <mat-checkbox
            (ngModelChange)="addToArray($event, getAssignmentByPropertyId(property.id).propertyId)"
            [ngModel]="getAssignmentIsCheckedByPropertyId(property.id)"
            [class.mb-2]="availableProperties.length > 2 && !isLast && propertyIndex != availableProperties.length - 2"
          >
            {{ property.name }}
          </mat-checkbox>
        </ng-container>
      </div>
    </mat-card-content>
  </mat-card>
  <mat-card class="mb-3" *ngFor="let translation of newDocumentModel.documentTranslations; let translationIndex = index">
    <mat-card-title>{{ languages[translationIndex].text }}</mat-card-title>
    <mat-card-content class="d-flex flex-column need-wrapper">
      <mat-form-field>
        <mat-label>{{'Name' | translate}}</mat-label>
        <input
          matInput
          type="text"
          id="createFolderNameTranslation_{{ translationIndex }}"
          name="createFolderNameTranslation_{{translationIndex}}"
          [(ngModel)]="translation.name"
        />
      </mat-form-field>
      <formatting-text-editor
        [(value)]="translation.description"
        [placeholder]="'Description' | translate"
        id="createFolderDescriptionTranslation_{{translationIndex}}"
      >
      </formatting-text-editor>
      <div class="mt-3">
        <input
          type="file"
          hidden
          [accept]="'application/pdf'"
          (change)="onFileSelected($event, languages[translationIndex].id)"
          id="pdfInput{{ translationIndex }}"
          #fileUpload
        />
        <div>{{getFileNameByLanguage(languages[translationIndex].id) || 'No file uploaded yet.' | translate}}
          <button
            mat-raised-button
            color="accent"
            (click)="fileUpload.click()"
          >
            {{ 'Upload' | translate }}
          </button>
          <ng-container *ngIf="getFileNameByLanguage(languages[translationIndex].id)">
            <button
              mat-icon-button
              color="accent"
              (click)="getPdf(languages[translationIndex].id)"
              matTooltip="{{ 'Show PDF' | translate }}"
            >
              <mat-icon svgIcon="file-pdf"></mat-icon>
            </button>
          </ng-container>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
  <mat-card class="mb-3">
    <mat-card-content>
      <mat-form-field  [owlDateTimeTrigger]="dt1">
        <mat-label>{{'End date' | translate}}</mat-label>
        <input
          matInput
          [owlDateTime]="dt1"
          [ngModel]="newDocumentModel.endDate"
          (ngModelChange)="updateStartDate($event)"
          type="text"
          id="createStartFrom"
          name="createStartFrom"
        />
        <owl-date-time [pickerType]="'calendar'" #dt1></owl-date-time>
      </mat-form-field>
    </mat-card-content>
  </mat-card>
</div>
<div mat-dialog-actions class="d-flex flex-row justify-content-end">
  <button
    mat-raised-button
    color="accent"
    id="folderSaveBtn"
    (click)="updateDocument()"
  >
    {{ 'Update' | translate }}
  </button>
  <button
    mat-raised-button
    id="cancelCreateBtn"
    (click)="hide()"
  >
    {{ 'Cancel' | translate }}
  </button>
</div>
