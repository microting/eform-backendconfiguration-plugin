
<form [formGroup]="form">
  <h3 mat-dialog-title>{{ (edit ? 'Edit employee' : 'New employee') | translate }}</h3>
  <div mat-dialog-content>
    <mat-tab-group
      dynamicHeight="false"
      [formGroup]="form"
    >
      <mat-tab label="{{'General' | translate }}" id="generalTab">
        <br>
        <div class="modal-columns">
          <div class="d-flex flex-column" id="column1">
            <mat-form-field>
              <mat-label>{{ 'First name' | translate }}</mat-label>
              <input
                matInput
                formControlName="userFirstName"
                required
                type="text"
                id="firstName"
                name="userName"
                tabindex="1"
                cdkFocusInitial>
              <mat-error *ngIf="form.get('userFirstName').hasError('required')">
                Required
              </mat-error>
            </mat-form-field>
            <mat-form-field>
              <mat-label>{{ 'e-mail' | translate }}</mat-label>
              <input
                matInput
                formControlName="workerEmail"
                type="email"
                id="workerEmail"
                required
                tabindex="3">
              <button
                *ngIf="shouldShowGenerateEmailButton()"
                matSuffix
                mat-icon-button
                type="button"
                (click)="generateRandomEmail()"
                matTooltip="{{ 'Generate random email' | translate }}"
                id="generateEmailBtn">
                <mat-icon>autorenew</mat-icon>
              </button>
              <mat-error *ngIf="form.get('workerEmail').hasError('invalidEmail')">
                Invalid email address
              </mat-error>
              <mat-error *ngIf="form.get('workerEmail').hasError('required')">
                Required
              </mat-error>
            </mat-form-field>
            <mat-form-field>
              <mat-label>{{ 'Employee no' | translate }}</mat-label>
              <input
                matInput
                formControlName="employeeNo"
                type="text"
                id="employeeNo"
                tabindex="5">
            </mat-form-field>
            <mat-form-field>
              <mat-label>{{ 'Language' | translate }}</mat-label>
              <mtx-select
                tabindex="7"
                id="profileLanguageSelector"
                [bindLabel]="'name'"
                [bindValue]="'languageCode'"
                [clearable]="false"
                formControlName="languageCode"
                [items]="activeLanguages">
                <ng-template ng-label-tmp let-item="item">
                  {{ item.name | translate }}
                </ng-template>
                <ng-template ng-option-tmp let-item="item">
                  {{ item.name | translate }}
                </ng-template>
              </mtx-select>
            </mat-form-field>
          </div>
          <div class="d-flex flex-column" id="column2">
            <mat-form-field>
              <mat-label>{{ 'Last name' | translate }}</mat-label>
              <input
                matInput
                formControlName="userLastName"
                type="text"
                id="lastName"
                required
                tabindex="2">
              <mat-error *ngIf="form.get('userLastName').hasError('required')">
                Required
              </mat-error>
            </mat-form-field>
            <mat-form-field>
              <mat-label>{{ 'Phone' | translate }}</mat-label>
              <input
                matInput
                formControlName="phoneNumber"
                type="tel"
                name="phoneNumber"
                id="phoneNumber"
                tabindex="4">
            </mat-form-field>
            <mat-form-field>
              <mat-label>{{ 'PIN code' | translate }}</mat-label>
              <input
                matInput
                formControlName="pinCode"
                type="text"
                name="pinCode"
                pattern="([0-9]*|\*{4})"
                id="pinCode"
                tabindex="6">
            </mat-form-field>
          </div>
        </div>
        <div class="modal-columns">
          <mat-form-field>
            <mat-label>{{ 'Current tags' | translate }}</mat-label>
            <mtx-select
              tabindex="8"
              class="custom"
              [dropdownPosition]="'bottom'"
              [bindValue]="'id'"
              [bindLabel]="'name'"
              [items]="availableTags"
              id="tagSelector"
              [multiple]="true"
              appendTo="body"
              formControlName="tags">
            </mtx-select>
          </mat-form-field>
        </div>
        <div class="modal-columns">
          <div class="d-flex flex-column" id="column1">
            <mat-slide-toggle
              color="primary"
              class="mb-2"
              id="resignedToggle"
              formControlName="resigned">
              {{ "Resigned" | translate }}
            </mat-slide-toggle>
          </div>
          <div class="d-flex flex-column" id="column2">
            <mat-form-field *ngIf="selectedDeviceUser.resigned">
              <mat-label>{{ 'Resigned at date' | translate }}</mat-label>
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <input
                required
                matInput
                [matDatepicker]="picker"
                formControlName="resignedAtDate"
                (click)="picker.open()"
              >
              <mat-datepicker #picker></mat-datepicker>
              <mat-error class="text-warn" *ngIf="!selectedDeviceUser.resignedAtDate">
                {{ 'Date is required'| translate }}*
              </mat-error>
            </mat-form-field>
          </div>
        </div>
        <br>
        <div class="modal-columns">
          <div class="d-flex flex-column" id="column1">
            <mat-slide-toggle
              *ngIf="authStateService.checkClaim('time_registration_enable')"
              color="primary"
              class="mb-2"
              id="timeRegistrationEnabledToggle"
              formControlName="timeRegistrationEnabled">
              {{ "Timeregistration" | translate }}
            </mat-slide-toggle>
            <br>
            <mat-slide-toggle
              *ngIf="authStateService.checkClaim('time_registration_enable') && selectedDeviceUser.timeRegistrationEnabled"
              color="primary"
              class="mb-2"
              id="enableMobileAccessToggle"
              formControlName="enableMobileAccess">
              {{ "Mobile timeregistration" | translate }}
            </mat-slide-toggle>
            <br>
            <mat-slide-toggle
              *ngIf="authStateService.checkClaim('task_management_enable') && assignments.length > 0"
              color="primary"
              class="mb-2"
              id="taskManagementEnabledToggle"
              formControlName="taskManagementEnabled">
              {{ "Task management" | translate }}
            </mat-slide-toggle>
          </div>
          <div class="d-flex flex-column" id="column2">
            <mat-slide-toggle
              color="primary"
              class="mb-2"
              id="webAccessEnabled"
              formControlName="webAccessEnabled">
              {{ "Backend user" | translate }}
            </mat-slide-toggle>
            <br>
            <mat-slide-toggle
              color="primary"
              class="mb-2"
              id="archiveEnabled"
              formControlName="archiveEnabled">
              {{ "Archive" | translate }}
            </mat-slide-toggle>
          </div>
        </div>
        <br>
      </mat-tab>
      <mat-tab label="{{'Properties' | translate }}" id="propertiesTab">
        <div class="modal-columns">
          <div class="d-flex flex-column" id="column2">
            <br>
            <mtx-grid
              [data]="availableProperties"
              [columns]="tableHeaders"
              [cellTemplate]="{select: selectTpl}"
              [pageOnFront]="false"
              [rowStriped]="true"
              [showPaginator]="false"
              id="pairingModalTableBody"
            >
            </mtx-grid>

            <ng-template #selectTpl let-row let-i="index">
              <div class="column-select">
                <mat-checkbox
                  id="checkboxCreateAssignment{{ i }}"
                  (change)="addToArray($event, getAssignmentByPropertyId(row.id).propertyId)"
                  [checked]="getAssignmentIsCheckedByPropertyId(row.id)"
                  [disabled]="getAssignmentIsLockedByPropertyId(row.id)"
                ></mat-checkbox>
              </div>
            </ng-template>
            <br>
          </div>
        </div>

      </mat-tab>
      <mat-tab
        *ngIf="selectedDeviceUser.timeRegistrationEnabled"
        label="{{'Timeregistration' | translate }}"
        id="timeregistrationTab">
        <br>
        
        <!-- Nested tab-group for time registration sub-tabs -->
        <mat-tab-group dynamicHeight="false">
          
          <!-- General Settings Sub-Tab -->
          <mat-tab label="{{'General' | translate }}" id="generalTimeRegistrationTab">
            <br>
            <div class="modal-columns">
              <div class="d-flex flex-column" id="timeRegistrationColumn">
                
                <!-- Time Registration Settings -->
                <h4>{{ 'Time Registration Settings' | translate }}</h4>
                
                <div class="d-flex flex-row" *ngIf="!selectedDeviceUser.resigned">
                  <mat-checkbox class="p-1"
                                id="useGoogleSheetAsDefault"
                                formControlName="useGoogleSheetAsDefault">
                    <div>
                      <div>{{ 'Use Google Sheet as default' | translate }}</div>
                    </div>
                  </mat-checkbox>
                </div>

                <div class="d-flex flex-row" *ngIf="!selectedDeviceUser.resigned && !form.value.useGoogleSheetAsDefault">
                  <mat-checkbox class="p-1"
                                id="useOnlyPlanHours"
                                formControlName="useOnlyPlanHours">
                    <div>
                      <div>{{ 'Use only plan hours' | translate }}</div>
                    </div>
                  </mat-checkbox>
                </div>

                <div class="d-flex flex-row" *ngIf="!selectedDeviceUser.resigned">
                  <mat-checkbox class="p-1"
                                id="autoBreakCalculationActive"
                                formControlName="autoBreakCalculationActive">
                    <div>
                      <div>{{ 'Auto break calculation' | translate }}</div>
                    </div>
                  </mat-checkbox>
                </div>

                <div class="d-flex flex-row" *ngIf="!selectedDeviceUser.resigned">
                  <mat-checkbox class="p-1"
                                id="allowPersonalTimeRegistration"
                                formControlName="allowPersonalTimeRegistration">
                    <div>
                      <div>{{ 'Allow time registration on mobile' | translate }}</div>
                      <small class="checkbox-description">{{ 'Enter start time, stop time, and total break. Select Allow editing of work hours on mobile to edit times.' | translate }}</small>
                    </div>
                  </mat-checkbox>
                </div>

                <div class="d-flex flex-row" *ngIf="!form.value.daysBackInTimeAllowedEditingEnabled && !selectedDeviceUser.resigned && form.value.allowPersonalTimeRegistration">
                  <mat-checkbox class="p-1"
                                id="allowEditOfRegistrations"
                                formControlName="allowEditOfRegistrations">
                    <div>
                      <div>{{ 'Allow editing of working hours on mobile' | translate }}</div>
                      <small class="checkbox-description">{{ 'Start time, stop time and breaks can be edited.' | translate }}</small>
                    </div>
                  </mat-checkbox>
                </div>

                <div class="d-flex flex-row" *ngIf="!selectedDeviceUser.resigned && form.value.allowPersonalTimeRegistration && !form.value.allowAcceptOfPlannedHours">
                  <mat-checkbox class="p-1"
                                id="usePunchClock"
                                formControlName="usePunchClock">
                    <div>
                      <div>{{ 'Use time clock on mobile' | translate }}</div>
                      <small class="checkbox-description">{{ 'Working hours are recorded by pressing Start/Stop working hours. Breaks are recorded by pressing Start/Stop break time. Select Allow editing of working hours on mobile to edit times.' | translate }}</small>
                    </div>
                  </mat-checkbox>
                </div>

                <div class="d-flex flex-row" *ngIf="!form.value.daysBackInTimeAllowedEditingEnabled && !selectedDeviceUser.resigned && form.value.allowPersonalTimeRegistration && !form.value.allowAcceptOfPlannedHours && form.value.usePunchClock">
                  <mat-checkbox class="p-1"
                                id="usePunchClockWithAllowRegisteringInHistory"
                                formControlName="usePunchClockWithAllowRegisteringInHistory">
                    <div>
                      <div>{{ 'Allow entry of unregistered working hours on mobile' | translate }}</div>
                      <small class="checkbox-description">{{ 'Enter start time, stop time, and total break time back in time. Select Allow editing of work hours on mobile to edit times.' | translate }}</small>
                    </div>
                  </mat-checkbox>
                </div>

                <div class="d-flex flex-row" *ngIf="!selectedDeviceUser.resigned && form.value.allowPersonalTimeRegistration && !form.value.usePunchClock">
                  <mat-checkbox class="p-1"
                                id="allowAcceptOfPlannedHours"
                                formControlName="allowAcceptOfPlannedHours">
                    <div>
                      <div>{{ 'Allow receipt for standard time on mobile' | translate }}</div>
                      <small class="checkbox-description">{{ 'Scheduled working hours can be approved with a single click. Scheduled working hours cannot be edited.' | translate }}</small>
                    </div>
                  </mat-checkbox>
                </div>

                <div class="d-flex flex-row" *ngIf="!selectedDeviceUser.resigned && form.value.allowPersonalTimeRegistration && form.value.allowEditOfRegistrations">
                  <mat-checkbox class="p-1"
                                id="daysBackInTimeAllowedEditingEnabled"
                                formControlName="daysBackInTimeAllowedEditingEnabled">
                    <div>
                      <div>{{ 'Allow x days back in time editing' | translate }}</div>
                      <small class="checkbox-description">{{ 'Enabling this option allows the user to edit x days back in time, default is 2.' | translate }}</small>
                    </div>
                  </mat-checkbox>
                </div>

                <div class="d-flex flex-row" *ngIf="!selectedDeviceUser.resigned && form.value.daysBackInTimeAllowedEditingEnabled">
                  <mat-form-field class="p-1">
                    <mat-label>{{ 'Days back in time allowed editing' | translate }}</mat-label>
                    <input matInput type="number" formControlName="daysBackInTimeAllowedEditing" id="daysBackInTimeAllowedEditing">
                  </mat-form-field>
                </div>

                <div class="d-flex flex-row" *ngIf="!selectedDeviceUser.resigned">
                  <mat-checkbox class="p-1"
                                id="thirdShiftActive"
                                formControlName="thirdShiftActive">
                    <div>{{ 'Enable third shift' | translate }}</div>
                  </mat-checkbox>
                  <mat-checkbox class="p-1" *ngIf="form.value.thirdShiftActive"
                                id="fourthShiftActive"
                                formControlName="fourthShiftActive">
                    <div>{{ 'Enable fourth shift' | translate }}</div>
                  </mat-checkbox>
                  <mat-checkbox class="p-1" *ngIf="form.value.fourthShiftActive && form.value.thirdShiftActive"
                                id="fifthShiftActive"
                                formControlName="fifthShiftActive">
                    <div>{{ 'Enable fifth shift' | translate }}</div>
                  </mat-checkbox>
                </div>

                <div class="d-flex flex-row" *ngIf="!selectedDeviceUser.resigned">
                  <mat-checkbox class="p-1"
                                id="isManager"
                                formControlName="isManager">
                    <div>
                      <div>{{ 'Is manager' | translate }}</div>
                      <small class="checkbox-description">{{ 'Set this user as a manager' | translate }}</small>
                    </div>
                  </mat-checkbox>
                </div>

                <div class="d-flex flex-row" *ngIf="!selectedDeviceUser.resigned && form.value.isManager">
                  <mat-form-field class="p-1 w-100">
                    <mat-label>{{ 'Managing tags' | translate }}</mat-label>
                    <mtx-select
                      [items]="availableTags"
                      bindLabel="name"
                      bindValue="id"
                      [multiple]="true"
                      placeholder="{{ 'Select tags' | translate }}"
                      formControlName="managingTagIds">
                    </mtx-select>
                    <mat-hint>{{ 'Select tags that this manager is responsible for' | translate }}</mat-hint>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </mat-tab>
          
          <!-- Auto Break Calculation Settings Sub-Tab -->
          <mat-tab 
            label="{{ 'Auto break calculation settings' | translate }}"
            *ngIf="form.value.autoBreakCalculationActive"
            id="autoBreakTab">
            <br>
            <div class="modal-columns">
              <div class="d-flex flex-column">
                <h4>{{ 'Auto break calculation settings' | translate }}</h4>
                <p class="text-muted">{{ 'Configure automatic break calculation settings for each day of the week.' | translate }}</p>
                
                <ng-container *ngFor="let day of ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']">
                  <div class="d-flex flex-row align-items-center">
                    <mat-form-field class="p-1">
                      <mat-label>{{ day + ' break time divider in minutes' | translate }}</mat-label>
                      <input
                        matInput
                        type="time"
                        placeholder="HH:MM"
                        [id]="day.toLowerCase() + 'BreakMinutesDivider'"
                        [name]="day.toLowerCase() + 'BreakMinutesDivider'">
                    </mat-form-field>
                    <mat-form-field class="p-1">
                      <mat-label>{{ day.toLowerCase() + ' break time pr divider in minutes' | translate }}</mat-label>
                      <input
                        matInput
                        type="time"
                        placeholder="HH:MM"
                        [id]="day.toLowerCase() + 'BreakMinutesPrDivider'"
                        [name]="day.toLowerCase() + 'BreakMinutesPrDivider'">
                    </mat-form-field>
                    <mat-form-field class="p-1">
                      <mat-label>{{ day + ' break upper limit' | translate }}</mat-label>
                      <input
                        matInput
                        type="time"
                        placeholder="HH:MM"
                        [id]="day.toLowerCase() + 'BreakMinutesUpperLimit'"
                        [name]="day.toLowerCase() + 'BreakMinutesUpperLimit'">
                    </mat-form-field>
                    <div class="pt-2">
                      <button
                        [id]="day.toLowerCase() + 'LoadDefaults'"
                        class="btn-secondary btn-secondary--icon-square-border"
                        type="button">
                        <mat-icon>sync_arrow_down</mat-icon>
                      </button>
                    </div>
                  </div>
                </ng-container>
              </div>
            </div>
          </mat-tab>

          <!-- Working Hours (1st Shift) Sub-Tab -->
          <mat-tab 
            label="{{'1st shift' | translate }}"
            *ngIf="!form.value.useOnlyPlanHours && !form.value.useGoogleSheetAsDefault"
            id="firstShiftTab">
            <br>
            <div class="modal-columns">
              <div class="d-flex flex-column" id="workingHoursColumn">
                <h4>{{ 'Working Hours Configuration' | translate }}</h4>
                <p class="text-muted">{{ 'Configure the start time, end time, and break duration for each day of the week. Times are in minutes from midnight (0-1440).' | translate }}</p>
                
            <!-- Monday -->
            <div class="day-row">
              <h5>{{ 'Monday' | translate }}</h5>
              <div class="time-inputs">
                <mat-form-field>
                  <mat-label>{{ 'Start time' | translate }}</mat-label>
                  <input matInput type="time" 
                    [value]="minutesToTime(form.get('startMonday')?.value)"
                    (change)="form.patchValue({startMonday: timeToMinutes($any($event.target).value)})"
                    id="startMonday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'End time' | translate }}</mat-label>
                  <input matInput type="time"
                    [value]="minutesToTime(form.get('endMonday')?.value)"
                    (change)="form.patchValue({endMonday: timeToMinutes($any($event.target).value)})"
                    id="endMonday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'Break (minutes)' | translate }}</mat-label>
                  <input matInput type="number" formControlName="breakMonday" id="breakMonday">
                </mat-form-field>
              </div>
            </div>

            <!-- Tuesday -->
            <div class="day-row">
              <h5>{{ 'Tuesday' | translate }}</h5>
              <div class="time-inputs">
                <mat-form-field>
                  <mat-label>{{ 'Start time' | translate }}</mat-label>
                  <input matInput type="time"
                    [value]="minutesToTime(form.get('startTuesday')?.value)"
                    (change)="form.patchValue({startTuesday: timeToMinutes($any($event.target).value)})"
                    id="startTuesday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'End time' | translate }}</mat-label>
                  <input matInput type="time"
                    [value]="minutesToTime(form.get('endTuesday')?.value)"
                    (change)="form.patchValue({endTuesday: timeToMinutes($any($event.target).value)})"
                    id="endTuesday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'Break (minutes)' | translate }}</mat-label>
                  <input matInput type="number" formControlName="breakTuesday" id="breakTuesday">
                </mat-form-field>
              </div>
            </div>

            <!-- Wednesday -->
            <div class="day-row">
              <h5>{{ 'Wednesday' | translate }}</h5>
              <div class="time-inputs">
                <mat-form-field>
                  <mat-label>{{ 'Start time' | translate }}</mat-label>
                  <input matInput type="time"
                    [value]="minutesToTime(form.get('startWednesday')?.value)"
                    (change)="form.patchValue({startWednesday: timeToMinutes($any($event.target).value)})"
                    id="startWednesday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'End time' | translate }}</mat-label>
                  <input matInput type="time"
                    [value]="minutesToTime(form.get('endWednesday')?.value)"
                    (change)="form.patchValue({endWednesday: timeToMinutes($any($event.target).value)})"
                    id="endWednesday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'Break (minutes)' | translate }}</mat-label>
                  <input matInput type="number" formControlName="breakWednesday" id="breakWednesday">
                </mat-form-field>
              </div>
            </div>

            <!-- Thursday -->
            <div class="day-row">
              <h5>{{ 'Thursday' | translate }}</h5>
              <div class="time-inputs">
                <mat-form-field>
                  <mat-label>{{ 'Start time' | translate }}</mat-label>
                  <input matInput type="time"
                    [value]="minutesToTime(form.get('startThursday')?.value)"
                    (change)="form.patchValue({startThursday: timeToMinutes($any($event.target).value)})"
                    id="startThursday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'End time' | translate }}</mat-label>
                  <input matInput type="time"
                    [value]="minutesToTime(form.get('endThursday')?.value)"
                    (change)="form.patchValue({endThursday: timeToMinutes($any($event.target).value)})"
                    id="endThursday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'Break (minutes)' | translate }}</mat-label>
                  <input matInput type="number" formControlName="breakThursday" id="breakThursday">
                </mat-form-field>
              </div>
            </div>

            <!-- Friday -->
            <div class="day-row">
              <h5>{{ 'Friday' | translate }}</h5>
              <div class="time-inputs">
                <mat-form-field>
                  <mat-label>{{ 'Start time' | translate }}</mat-label>
                  <input matInput type="time"
                    [value]="minutesToTime(form.get('startFriday')?.value)"
                    (change)="form.patchValue({startFriday: timeToMinutes($any($event.target).value)})"
                    id="startFriday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'End time' | translate }}</mat-label>
                  <input matInput type="time"
                    [value]="minutesToTime(form.get('endFriday')?.value)"
                    (change)="form.patchValue({endFriday: timeToMinutes($any($event.target).value)})"
                    id="endFriday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'Break (minutes)' | translate }}</mat-label>
                  <input matInput type="number" formControlName="breakFriday" id="breakFriday">
                </mat-form-field>
              </div>
            </div>

            <!-- Saturday -->
            <div class="day-row">
              <h5>{{ 'Saturday' | translate }}</h5>
              <div class="time-inputs">
                <mat-form-field>
                  <mat-label>{{ 'Start time' | translate }}</mat-label>
                  <input matInput type="time"
                    [value]="minutesToTime(form.get('startSaturday')?.value)"
                    (change)="form.patchValue({startSaturday: timeToMinutes($any($event.target).value)})"
                    id="startSaturday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'End time' | translate }}</mat-label>
                  <input matInput type="time"
                    [value]="minutesToTime(form.get('endSaturday')?.value)"
                    (change)="form.patchValue({endSaturday: timeToMinutes($any($event.target).value)})"
                    id="endSaturday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'Break (minutes)' | translate }}</mat-label>
                  <input matInput type="number" formControlName="breakSaturday" id="breakSaturday">
                </mat-form-field>
              </div>
            </div>

            <!-- Sunday -->
            <div class="day-row">
              <h5>{{ 'Sunday' | translate }}</h5>
              <div class="time-inputs">
                <mat-form-field>
                  <mat-label>{{ 'Start time' | translate }}</mat-label>
                  <input matInput type="time"
                    [value]="minutesToTime(form.get('startSunday')?.value)"
                    (change)="form.patchValue({startSunday: timeToMinutes($any($event.target).value)})"
                    id="startSunday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'End time' | translate }}</mat-label>
                  <input matInput type="time"
                    [value]="minutesToTime(form.get('endSunday')?.value)"
                    (change)="form.patchValue({endSunday: timeToMinutes($any($event.target).value)})"
                    id="endSunday">
                </mat-form-field>
                <mat-form-field>
                  <mat-label>{{ 'Break (minutes)' | translate }}</mat-label>
                  <input matInput type="number" formControlName="breakSunday" id="breakSunday">
                </mat-form-field>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>
        
      </mat-tab-group>
    </mat-tab>
  </mat-tab-group>
</div>
  <div mat-dialog-actions class="d-flex flex-row justify-content-end">
    <button
      class="btn-cancel"
      id="{{edit ? 'cancelEditBtn' : 'cancelCreateBtn'}}"
      (click)="hide()"
    >
      {{ 'Cancel' | translate }}
    </button>
    <button
      tabindex="9"
      class="btn-primary btn-primary--icon-left"
      (click)="edit ? updateSingle() : createDeviceUser()"
      [disabled]="form.invalid"
      id="{{edit ? 'saveEditBtn' : 'saveCreateBtn'}}"
    >
      <span>{{ (edit ? 'Save' : 'Create') | translate }}</span>
    </button>
  </div>
</form>
